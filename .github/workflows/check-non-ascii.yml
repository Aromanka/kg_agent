name: Check Non-ASCII Characters

on:
  push:
    branches:
      - main
      - final
  pull_request:
    branches:
      - main
      - final

jobs:
  check_non_ascii:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Check for non-ASCII characters
        run: |
          # -r: 递归搜索
          # -P: 使用 Perl 正则 (支持 \xHH)
          # -l: 只输出文件名 (如果找到)
          # --include: 指定文件类型
          
          if grep -rP "[^\x00-\x7F]" . \
              --include="*.txt" \
              --include="*.md" \
              --include="*.py" \
              --include="*.js" \
              --include="*.cpp" > result.log; then
              
            echo "❌ Found non-ASCII characters in the following files:"
            cat result.log
            exit 1
          else
            echo "✅ No non-ASCII characters found."
          fi
