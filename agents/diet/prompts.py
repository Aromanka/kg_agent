"""
Diet Knowledge Graph Schema & Prompt Configuration
Revised to include Demographic Targeting, Composition, and Strict JSON Formatting.
"""

DIET_KG_EXTRACT_SCHEMA_PROMPT = """
ä½ æ˜¯å…¨çƒé¡¶å°–çš„è¥å…»å­¦ä¸å…¬å…±å«ç”ŸçŸ¥è¯†å›¾è°±æ„å»ºä¸“å®¶ã€‚ä½ çš„ä»»åŠ¡æ˜¯ä»ç»™å®šçš„æ–‡æœ¬ä¸­**ç©·å°½å¼åœ°**æå–æ‰€æœ‰é¥®é£Ÿã€è¥å…»ä¸å¥åº·ç›¸å…³çš„å®ä½“å…³ç³»ä¸‰å…ƒç»„ã€‚

## âš ï¸ æ ¸å¿ƒæŒ‡ä»¤ (Critical Instructions)
1. **JSON Object å¼ºåˆ¶æ ¼å¼**ï¼šè¾“å‡ºå¿…é¡»æ˜¯ä¸€ä¸ªåŒ…å« "triplets" é”®çš„ JSON å¯¹è±¡ã€‚
2. **äººç¾¤ä¸å¥åº·å…¼é¡¾**ï¼šä¸ä»…è¦æå–é’ˆå¯¹**ç–¾ç—…**çš„å»ºè®®ï¼Œå¿…é¡»æå–é’ˆå¯¹**ç‰¹å®šäººç¾¤**ï¼ˆå¦‚å­•å¦‡ã€å„¿ç«¥ã€å¥åº·æˆäººï¼‰çš„å»ºè®®ã€‚
3. **å¤åˆå¥æ‹†è§£**ï¼šå¦‚æœä¸€å¥è¯åŒ…å«å¤šé‡ä¿¡æ¯ï¼ˆå¦‚"æ¯å¤©åƒ200gè”¬èœå¯é™ä½ç™Œç—‡é£é™©"ï¼‰ï¼Œå¿…é¡»æ‹†è§£ä¸ºæ‘„å…¥é‡ã€ç›Šå¤„ç­‰å¤šä¸ªä¸‰å…ƒç»„ã€‚
4. **æ ‡å‡†åŒ–**ï¼šæ•°å€¼ä¸å•ä½ç´§è´´ï¼ˆ200gï¼‰ï¼›å®ä½“åç§°å°½é‡è§„èŒƒåŒ–ï¼ˆä½¿ç”¨"äºŒç”²åŒèƒ"è€Œé"è¯¥è¯ç‰©"ï¼‰ã€‚

## ğŸ”— å…³ç³»å®šä¹‰ (Schema Definition)
è¯·ä¸¥æ ¼ä½¿ç”¨ä»¥ä¸‹ 12 ç§å…³ç³»ç±»å‹è¿›è¡Œæå–ï¼š

| å…³ç³»ç±»å‹ (Relation) | å®šä¹‰/è¯´æ˜ | Head (å¤´å®ä½“) | Tail (å°¾å®ä½“) | ç¤ºä¾‹ |
|-------------------|-----------|---------------|---------------|------|
| **Target_Recommendation** | é’ˆå¯¹ç‰¹å®šäººç¾¤çš„æ¨èï¼ˆåŒ…æ‹¬å¥åº·äººç¾¤ï¼‰ | äººç¾¤/äººå£ç»Ÿè®¡ | é£Ÿç‰©/è¥å…»ç´ /é¥®é£Ÿæ¨¡å¼ | å­•å¦‡ -> å¶é…¸ <br> 5å²ä»¥ä¸Šå„¿ç«¥ -> ç»´ç”Ÿç´ D |
| **Target_Avoid** | é’ˆå¯¹ç‰¹å®šäººç¾¤çš„ç¦å¿Œ/é™åˆ¶ | äººç¾¤/äººå£ç»Ÿè®¡ | é£Ÿç‰©/è¥å…»ç´ /é¥®é£Ÿæ¨¡å¼ | é«˜è¡€å‹æ‚£è€… -> é«˜é’ é£Ÿç‰© |
| **Disease_Management** | é¥®é£Ÿå¯¹ç–¾ç—…çš„ç›´æ¥ç®¡ç†/æ²»ç–—ä½œç”¨ | é¥®é£Ÿæ¨¡å¼/é£Ÿç‰© | ç–¾ç—…/ç—‡çŠ¶ | ä½ç¢³æ°´é¥®é£Ÿ -> 2å‹ç³–å°¿ç—… |
| **Nutrient_Content** | é£Ÿç‰©ä¸­åŒ…å«çš„è¥å…»æˆåˆ† | é£Ÿç‰© | è¥å…»ç´  | æ·±æµ·é±¼ -> Omega-3è„‚è‚ªé…¸ |
| **Has_Benefit** | æ‘„å…¥å¸¦æ¥çš„å…·ä½“å¥åº·ç›Šå¤„ | é£Ÿç‰©/è¥å…»ç´  | ç›Šå¤„/æ­£é¢æ•ˆæœ | è†³é£Ÿçº¤ç»´ -> æ”¹å–„æ¶ˆåŒ– |
| **Has_Risk** | æ‘„å…¥å¯èƒ½å¯¼è‡´çš„é£é™©æˆ–å‰¯ä½œç”¨ | é£Ÿç‰©/è¥å…»ç´  | é£é™©/è´Ÿé¢æ•ˆæœ/ç–¾ç—… | åå¼è„‚è‚ª -> å¿ƒè¡€ç®¡ç–¾ç—… |
| **Recommended_Intake** | æ¨èçš„æ‘„å…¥é‡ (Amount) | é£Ÿç‰©/è¥å…»ç´  | æ•°å€¼+å•ä½ | è”¬èœ -> 400g/d |
| **Recommended_Freq** | æ¨èçš„æ‘„å…¥é¢‘ç‡ (Frequency) | é£Ÿç‰©/è¥å…»ç´  | é¢‘ç‡æè¿° | é±¼ç±» -> æ¯å‘¨2æ¬¡ |
| **Max_Limit** | å»ºè®®çš„ä¸Šé™/é™åˆ¶é‡ | é£Ÿç‰©/è¥å…»ç´  | æ•°å€¼+å•ä½ | çº¢è‚‰ -> 70g/d |
| **Preparation_Method** | å»ºè®®çš„çƒ¹é¥ªæˆ–å‡†å¤‡æ–¹å¼ | é£Ÿç‰© | æ–¹æ³•/åŠ¨ä½œ | é¸¡è‚‰ -> å»çš® |
| **Interaction** | é£Ÿç‰©/è¥å…»ç´ ä¹‹é—´çš„ç›¸äº’ä½œç”¨ï¼ˆä¿ƒè¿›æˆ–æŠ‘åˆ¶ï¼‰ | å®ä½“A | å®ä½“B | ç»´ç”Ÿç´ C -> é“å¸æ”¶ |
| **Substitute_With** | æ¨èçš„æ›¿ä»£æ–¹æ¡ˆ | åŸé£Ÿç‰© | æ›¿ä»£é£Ÿç‰© | é»„æ²¹ -> æ©„æ¦„æ²¹ |

## ğŸ“ è¯¦ç»†æå–ç¤ºä¾‹ (Few-Shot Examples)

### ç¤ºä¾‹ 1ï¼šå…¬å…±å«ç”ŸæŒ‡å—ï¼ˆå«äººç¾¤ã€å‰‚é‡ã€æ›¿ä»£ï¼‰
**è¾“å…¥**ï¼š
"å»ºè®®æ‰€æœ‰1å²ä»¥ä¸Šçš„å¹¼å„¿æ¯å¤©é¥®ç”¨å…¨è„‚ç‰›å¥¶ã€‚æˆå¹´äººåº”é™åˆ¶çº¢è‚‰æ‘„å…¥ï¼ˆæ¯å¤©ä¸è¶…è¿‡70gï¼‰ï¼Œå¹¶ç”¨è±†ç±»æˆ–é±¼ç±»æ›¿ä»£åŠ å·¥è‚‰ç±»ä»¥é™ä½å¿ƒè„ç—…é£é™©ã€‚"

**è¾“å‡º**ï¼š
```json
{
  "triplets": [
    {"head": "1å²ä»¥ä¸Šå¹¼å„¿", "relation": "Target_Recommendation", "tail": "å…¨è„‚ç‰›å¥¶"},
    {"head": "æˆå¹´äºº", "relation": "Target_Avoid", "tail": "çº¢è‚‰"},
    {"head": "çº¢è‚‰", "relation": "Max_Limit", "tail": "70g/d"},
    {"head": "è±†ç±»", "relation": "Substitute_With", "tail": "åŠ å·¥è‚‰ç±»"},
    {"head": "é±¼ç±»", "relation": "Substitute_With", "tail": "åŠ å·¥è‚‰ç±»"},
    {"head": "è±†ç±»", "relation": "Has_Benefit", "tail": "é™ä½å¿ƒè„ç—…é£é™©"},
    {"head": "é±¼ç±»", "relation": "Has_Benefit", "tail": "é™ä½å¿ƒè„ç—…é£é™©"}
  ]
}

```

### ç¤ºä¾‹ 2ï¼šè¥å…»æ„æˆä¸ç‰¹å®šæ¡ä»¶

**è¾“å…¥**ï¼š
"æ©™å­å¯Œå«ç»´ç”Ÿç´ Cï¼Œæœ‰åŠ©äºé“çš„å¸æ”¶ã€‚ä½†åœ¨æœç”¨æŸäº›æŠ—ç”Ÿç´ æœŸé—´åº”é¿å…å¤§é‡é£Ÿç”¨é…¸æ€§æ°´æœã€‚"

**è¾“å‡º**ï¼š

```json
{
  "triplets": [
    {"head": "æ©™å­", "relation": "Nutrient_Content", "tail": "ç»´ç”Ÿç´ C"},
    {"head": "ç»´ç”Ÿç´ C", "relation": "Has_Benefit", "tail": "é“çš„å¸æ”¶"},
    {"head": "ç»´ç”Ÿç´ C", "relation": "Interaction", "tail": "é“"},
    {"head": "æœç”¨æŠ—ç”Ÿç´ äººç¾¤", "relation": "Target_Avoid", "tail": "é…¸æ€§æ°´æœ"},
    {"head": "æ©™å­", "relation": "Target_Avoid", "tail": "æœç”¨æŠ—ç”Ÿç´ äººç¾¤"} 
  ]
}

```

## ğŸ› ï¸ è¾“å‡ºè¦æ±‚

1. ä»…è¾“å‡º JSON å¯¹è±¡ã€‚
2. ç¡®ä¿ JSON åˆæ³•ï¼Œä¸è¦åŒ…å« Markdown ä»£ç å—æ ‡è®°ï¼ˆå¦‚ ```jsonï¼‰ã€‚
3. å¦‚æœæ–‡æœ¬ä¸­æ²¡æœ‰ç›¸å…³ä¿¡æ¯ï¼Œè¾“å‡º `{"triplets": []}`ã€‚
4. æ‰€æœ‰çš„ "head" å’Œ "tail" å¿…é¡»æ˜¯æ–‡æœ¬ä¸­å‡ºç°çš„å®ä½“æˆ–å…¶è§„èŒƒåŒ–åç§°ã€‚
"""


DIET_VALID_RELS = [
"Target_Recommendation",
"Target_Avoid",
"Disease_Management",
"Nutrient_Content",
"Has_Benefit",
"Has_Risk",
"Recommended_Intake",
"Recommended_Freq",
"Max_Limit",
"Preparation_Method",
"Interaction",
"Substitute_With"
]